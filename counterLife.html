<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contatori</title>
<style>
    body {
        font-family: Arial, sans-serif;
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100vh;
        margin: 0;
        background-color: #f4f4f4;
    }
    .container {
        width: 100%;
        height: 100vh;
        display: grid;
        grid-template-columns: 1fr 1fr;
        grid-template-rows: 1fr 1fr;
        gap: 5px;
        position: relative;
    }
    .section {
        display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px;
    border: 1px solid #ddd;
    font-size: 36px;
    text-align: center;
    cursor: pointer;
    user-select: none;
    position: relative;
    transition: background-color 0.3s ease, background-image 0.5s ease;
    background-color: #f4f4f4;  /* Colore di sfondo di fallback */
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;

    /* Contorno bianco per il testo */
    color: white;
    text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.6), -2px -2px 5px rgba(0, 0, 0, 0.6); 
    /* Puoi regolare i valori per ottenere l'effetto che preferisci */
    }
    .half {
        width: 50%;
        padding: 20px;
        position: relative;
    }
    .half.left:active {
        background-color: rgba(0, 0, 0, 0.1); /* Scurisce la metà sinistra */
    }
    .half.right:active {
        background-color: rgba(0, 0, 0, 0.1); /* Scurisce la metà destra */
    }
    .options-button {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: #007bff;
        color: white;
        font-size: 16px;
        padding: 10px;
        border-radius: 50%;
        cursor: pointer;
        border: none;
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10;
    }
    .popup {
        display: none;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: white;
        padding: 20px;
        border: 1px solid #ddd;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        z-index: 20;
    }
    .popup button {
        margin-top: 10px;
        padding: 5px 10px;
        background-color: #007bff;
        color: white;
        border: none;
        cursor: pointer;
    }
    .popup input {
        display: block;
        margin-top: 10px;
        padding: 5px;
        font-size: 16px;
        width: 100%;
    }

</style>
</head>
<body>
<div class="container">
    <div class="section" id="section0">
        <div class="half">
            <div></div>
        </div>
        <div id="counter0">0</div>
        <div class="half">
            <div></div>
        </div>
    </div>
    <div class="section" id="section1">
        <div class="half">
            <div></div>
        </div>
        <div id="counter1">0</div>
        <div class="half">
            <div></div>
        </div>
    </div>
    <div class="section" id="section2">
        <div class="half">
            <div></div>
        </div>
        <div id="counter2">0</div>
        <div class="half">
            <div></div>
        </div>
    </div>
    <div class="section" id="section3">
        <div class="half">
            <div></div>
        </div>
        <div id="counter3">0</div>
        <div class="half">
            <div></div>
        </div>
    </div>
    <button class="options-button" onclick="openOptions()">⚙️</button>
<div id="popup" class="popup">
    <p>Opzioni disponibili</p>
    <input type="text" id="cardName" placeholder="Inserisci il nome della carta">
    
    <!-- Pulsanti per selezionare quale rettangolo usare per l'immagine -->
    <div>
        <button onclick="selectSection(0)">Sezione 1</button>
        <button onclick="selectSection(1)">Sezione 2</button>
        <button onclick="selectSection(2)">Sezione 3</button>
        <button onclick="selectSection(3)">Sezione 4</button>
    </div>
    
    <button onclick="setCardImage()">Imposta immagine</button>
    <button onclick="closeOptions()">Chiudi</button>
</div>

    <script>
        let counters = [0, 0, 0, 0];

        // Funzione per generare un colore casuale in formato esadecimale
        function getRandomColor() {
            const letters = '0123456789ABCDEF';
            let color = '#';
            for (let i = 0; i < 6; i++) {
                color += letters[Math.floor(Math.random() * 16)];
            }
            return color;
        }

        // Funzione per assegnare un colore casuale a ciascuna sezione
        function setRandomSectionColors() {
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => {
                section.style.backgroundColor = getRandomColor();
            });
        }

        // Funzioni per gestire le opzioni
        function openOptions() {
            document.getElementById("popup").style.display = "block";
        }

        function closeOptions() {
            document.getElementById("popup").style.display = "none";
        }

        function setCounters() {
            let newValue = parseInt(document.getElementById("setNumber").value);
            if (!isNaN(newValue)) {
                for (let i = 0; i < counters.length; i++) {
                    counters[i] = newValue;
                    document.getElementById(`counter${i}`).innerText = counters[i];
                }
            }
        }
        let selectedSectionIndex = -1; // Inizialmente nessuna sezione è selezionata

// Funzione per selezionare una sezione
function selectSection(index) {
    selectedSectionIndex = index;
    alert(`Sezione ${index + 1} selezionata`);
}

// Funzione per impostare l'immagine della carta come sfondo
function setCardImage() {
    if (selectedSectionIndex === -1) {
        alert('Per favore, seleziona una sezione prima di impostare l\'immagine.');
        return;
    }

    const cardName = document.getElementById('cardName').value.trim(); // Ottieni il nome della carta
    if (cardName === '') {
        alert('Per favore, inserisci il nome della carta');
        return;
    }

    // Chiediamo l'immagine della carta tramite l'API di Scryfall
    fetch(`https://api.scryfall.com/cards/named?fuzzy=${encodeURIComponent(cardName)}`)
        .then(response => response.json())
        .then(data => {
            // Verifica se la carta esiste
            if (data.object === 'error') {
                alert('Carta non trovata. Riprova.');
                return;
            }

            // Prendi l'URL dell'immagine della carta
            const cardImageUrl = data.image_uris.art_crop;
            console.log(data);
            // Seleziona la sezione che l'utente ha scelto
            const section = document.getElementById(`section${selectedSectionIndex}`);
            section.style.backgroundImage = `url(${cardImageUrl})`;  // Imposta l'immagine come sfondo

            // Impostiamo altre proprietà per far sì che l'immagine si adatti correttamente
            section.style.backgroundSize = 'cover'; // Copre tutta la sezione
            section.style.backgroundPosition = 'center'; // Centra l'immagine
            section.style.backgroundRepeat = 'no-repeat'; // Evita che l'immagine si ripeta
        })
        .catch(error => {
            alert('Errore nella richiesta dell\'immagine: ' + error);
        });
}

        // Impostiamo i colori casuali al caricamento della pagina
        window.onload = setRandomSectionColors;

        // Aggiungi gli eventi per ogni sezione
        const sections = document.querySelectorAll('.section');
        sections.forEach((section, index) => {
            section.addEventListener('click', () => {
                // Incrementa o decrementa in base al lato cliccato
                const counterElement = document.getElementById(`counter${index}`);
                const currentValue = counters[index];
                const rect = section.getBoundingClientRect();
                const clickX = event.clientX;

                if (clickX < rect.left + rect.width / 2) {
                    counters[index] = currentValue - 1; // Decrementa
                } else {
                    counters[index] = currentValue + 1; // Incrementa
                }
                counterElement.innerText = counters[index];
            });
        });
    </script>
</body>
</html>